<button onclick="doHomeWork()">Show result!</button>

<script>
    
    function doHomeWork() {

        let allPurchases = [];
        let recommendations = new Map();
        
        allPurchases = preparePurchasesRandomly( 10 );
        recommendations = prepareRecommendations( allPurchases );
        let result = findLongestRecommendation( recommendations );
        showResult ( allPurchases, result);
    }
    
    
    function preparePurchasesRandomly( purchasesNumber ) {
        let purchasesArray = [];
    
        for ( let i = 0; i < purchasesNumber; ++i ) {
            purchasesArray[ i ] = [];
			
            for ( let y = 0; y < Math.ceil(Math.random() * 10); ++y ) {
                let randomCharCode = Math.floor( Math.random() * 25) + 97;
				let purchaseItem = String.fromCharCode( randomCharCode );
				
				if ( !purchasesArray[i].includes( purchaseItem ))
					purchasesArray[i].push( purchaseItem );
            }
        }
    
        return purchasesArray;
    }
    
    
    function prepareRecommendations ( allPurchases ) {
            let purchasesList = new Map();
    
            for ( let singlePurchase of allPurchases ) {
                for ( let purchaseItem of singlePurchase) {
    
                    if ( purchasesList.has( purchaseItem )) {
						let purchaseSet = purchasesList.get( purchaseItem );
                        for ( let item of singlePurchase ) purchaseSet.add( item );
											
                    } else {
                        purchasesList.set( purchaseItem, new Set( singlePurchase ));
                    }
                }
            }
			
            return purchasesList;
    } 
    
    
    function findLongestRecommendation ( recommendations ) {
        let longestRecommendation = new Set();
        let longestRecommendationSize = 0;
    
        for ( let newRecommendationSet of recommendations.values()) {
            if ( longestRecommendationSize < newRecommendationSet.size ) {
                longestRecommendationSize = newRecommendationSet.size;
                longestRecommendation = newRecommendationSet;
            }
        }
    
        return longestRecommendation.keys();
    }
    
    
    function showResult ( purchases, result ) {
        let body = document.body;
        body.insertAdjacentHTML('beforeend', "<p>Все покупки:</p>");
        for ( let purchaseSet of purchases ) {
            body.insertAdjacentHTML('beforeend', purchaseSet.join(", ") + '<br />');
        }
    
        body.insertAdjacentHTML('beforeend', "Максимальная рекоммендация: " + [...result].join(', ') );
    }

</script>